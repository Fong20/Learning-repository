# 04. Network Layer
- Network layer provides logical communication between two hosts
- Internet protocol version 4 and Internet protocol version 6 are examples of protocols in the network layer

## Planes
Network layer is divided into two planes where each plane plays its own significant role

### Control plane
- Makes routing decision.
- Routing algorithms are run on the control plane to make routing decisions
- network wide function, It gathers information about the whole network to determine the most efficient route to transfer the packet

Two approaches:
1. Per-router control plane
- A traditional approach implemented in all routers where routing decisions are made by each router
- Each router computes its own forwarding table in a distributed manner.

2. Logically centralized control plane (Software-defined networking, SDN)
- A newer approach implemented in a remote controller.
- Centralized. Each router receives a forwarding table that is computed and distributed by a remote controller.

### Data plane
Takes the decision from the control plane and implements the decision by sending the packet accordingly.

## IPv4 Addressing
- IPv4 is a 32 bit address. Thus, it contains 2^32 IP addresses.
- Each IPv4 address identifies an interface
- IPv4 addresses are globally unqiue

### How does a host obtain an IP address?
A host can obtain an IP address through 2 methods:
- IP address assigned by the system admin
- IP address assigned to the host dynamically through DHCP.

Dynamic assignment of IP address to host using DHCP

### Network Address Translation (NAT)
- Main function of NAT is to convert private IPv4 addresses into public IPv4 addresses
- change in addresses of devices in local network or ISP will not affect
without notifying outside world
- devices inside local network not explicitly addressable, visible by outside world which enhances security

**NAT process**
1. Host with a source network address of 10.0.0.1 and port number of 3345 sends datagram to the destination with a network address of 128.119.40.186 with port number of 80 which is located in another network
2. As the datagram goes through the router, the router will translate the datagram source address from 10.0.0.1 with port number 3345 to a public address of 138.76.29.7 with port number 5001 and update its NAT translation table.
3. When the destination host sends a reply, the destination network address is now 138.76.29.7 with the port number of 5001.
4. 
5. only the port number is unique for each device, the NAT server translates the
   
![image](https://github.com/user-attachments/assets/9e681f25-2f98-452d-8e23-88fb61766f33)

### Translation from IPv4 to IPv6
- As IPv4 addresses are depleted, there is the need to transition to IPv6. However, IPv6 cannot be incorporated immediately but it needs to be incorporated gradually. Not all routers are upgraded to support Ipv6.
- Therefore, Tunneling is used to provide downward compatibility with transition from IPv4
- Tunneling: Carry IPv6 datagram as a payload in an IPv4 datagram among IPv4 routers. This means the the datagram's header is still utilizing IPv4 but the information of IPv6 is stored as the payload. As routers only process the datagram according to the header information, there wil be no issue in tranferring IPv6 datagram through IPv4 routers towards IPv6 routers to be processed.

  ![image](https://github.com/user-attachments/assets/91f1af78-b44f-418a-b186-0d2d52766c75)

  ![image](https://github.com/user-attachments/assets/39979413-041e-47b2-8674-41210c5a353b)

## Routing algorithms
Algorithms are a series of steps which are taken with the provision of inputs to produce an output.

Two types of routing algorithms:
1. Link state algorithm (centralized)
2. Distance vector algorithm (decentralized)

Link cost = cost which needs to be taken account before making a routing decision. There are acombination of factors determines the cost to transfer the packet through a particular link (Eg: badnwidth, distance of the link, energy consumption, throughput, number of hops etc). The link which have the lowest link cost will be chosen.
